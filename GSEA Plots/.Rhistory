scale_fill_gradient(low = "#D6EAF8", high = "#2E86C1") +
theme_void(base_size = 18) +
theme(
plot.title = element_text(size = 26, face = "bold", hjust = 0.5),
legend.position = "none"
) +
labs(title = "Shared and Unique Up-Regulated GSEA Pathways")
venn_plot_down <- ggVennDiagram(
venn_list_down,
label_alpha = 0,
label = "count"
) +
scale_fill_gradient(low = "#D6EAF8", high = "#2E86C1") +
theme_void(base_size = 18) +
theme(
plot.title = element_text(size = 26, face = "bold", hjust = 0.5),
legend.position = "none"
) +
labs(title = "Shared and Unique Down-Regulated GSEA Pathways")
# Save the final plots
ggsave("GSEA_Venn_Diagram_UpRegulated.pdf", plot = venn_plot_up, width = 10, height = 8, dpi = 600)
ggsave("GSEA_Venn_Diagram_DownRegulated.pdf", plot = venn_plot_down, width = 10, height = 8, dpi = 600)
# === 1. Map HGNC symbols to Entrez IDs using org.Hs.eg.db === #
get_entrez_ids <- function(core_enrichment_genes) {
# Map HGNC symbol to Entrez IDs using org.Hs.eg.db
entrez_ids <- sapply(core_enrichment_genes, function(symbol) {
# Try to get Entrez ID
entrez <- tryCatch({
as.character(org.Hs.egSYMBOL2EG[[symbol]])
}, error = function(e) {NA})
return(entrez)
})
return(entrez_ids)
}
# === 2. Extract core enrichment genes and map Entrez IDs === #
extract_gene_logfc_with_entrez <- function(gsea_df, logfc_column) {
gsea_df %>%
separate_rows(core_enrichment, sep = "/") %>%
rename(hgnc_id = core_enrichment) %>%  # Correct column name here
left_join(deg_df, by = "hgnc_id") %>%  # Join on hgnc_id instead of hgnc_symbol
mutate(entrezgene_id = get_entrez_ids(hgnc_id)) %>%
select(Description, hgnc_id, entrezgene_id, all_of(logfc_column)) %>%
rename(logFC = all_of(logfc_column))
}
# Extract and save the 2-day and 5-day data separately
ridge_data_2d <- extract_gene_logfc_with_entrez(shared_deg1, "logFC_2Day")
ridge_data_5d <- extract_gene_logfc_with_entrez(shared_deg2, "logFC_5Day")
# Save the results to separate CSV files
write.csv(ridge_data_2d, "GSEA_2Day_Entrez_Log2FC.csv", row.names = FALSE)
write.csv(ridge_data_5d, "GSEA_5Day_Entrez_Log2FC.csv", row.names = FALSE)
gseaplot(gsea_deg1, geneSetID = top_deg1$ID[1], title = top_deg1$Description[1])
# Load packages
library(clusterProfiler)
library(org.Hs.eg.db)
library(dplyr)
library(tidyr)
library(tibble)
library(pheatmap)
library(ggplot2)
library(ggridges)
library(forcats)
library(grid)
library(cowplot)
library(grid)
library(enrichplot)
# Install biomaRt if not already installed
# install.packages("biomaRt")
# install.packages("ggVennDiagram")  # Uncomment if not already installed
library(ggVennDiagram)
# === 1. Load DEG data === #
deg_2d <- read.csv("2DayCVB_3Col_hgnc.csv")      # Replace with actual filename
deg_5d <- read.csv("5DayCVB_3Col_hgnc.csv")      # Replace with actual filename
deg_df <- full_join(deg_2d, deg_5d, by = "hgnc_id", suffix = c("_2Day", "_5Day"))
# Ensure column names are clean
colnames(deg_2d) <- c("hgnc_id", "logFC_2Day", "pval_2Day")
colnames(deg_5d) <- c("hgnc_id", "logFC_5Day", "pval_5Day")
# Join by gene symbol
deg_df <- full_join(deg_2d, deg_5d, by = "hgnc_id")
# === 2. Top pathways setup === #
top_n <- 75
top_deg1 <- gsea_deg1@result %>% arrange(p.adjust) %>% head(top_n)
top_deg2 <- gsea_deg2@result %>% arrange(p.adjust) %>% head(top_n)
#Pathway truncation
#top_deg1$Description <- substr(top_deg1$Description, 1, 80)
#top_deg2$Description <- substr(top_deg2$Description, 1, 80)
shared_pathways <- intersect(top_deg1$Description, top_deg2$Description)
shared_deg1 <- gsea_deg1@result %>%
filter(Description %in% shared_pathways) %>%
select(Description, NES, core_enrichment) %>%
mutate(Timepoint = "2 dpi")
shared_deg2 <- gsea_deg2@result %>%
filter(Description %in% shared_pathways) %>%
select(Description, NES, core_enrichment) %>%
mutate(Timepoint = "5 dpi")
# === 3. Heatmap data === #
combined_nes <- bind_rows(shared_deg1, shared_deg2) %>%
select(Description, NES, Timepoint) %>%
pivot_wider(names_from = Timepoint, values_from = NES) %>%
column_to_rownames("Description")
combined_nes <- combined_nes[order(combined_nes$`2 dpi`, decreasing = TRUE), ]
custom_palette <- colorRampPalette(c("#deebf7", "#3182bd"))(50)
pheatmap_obj <- pheatmap(
combined_nes,
cluster_rows = TRUE,        # Keep rows clustered
cluster_cols = FALSE,       # Don't cluster columns
color = custom_palette,
main = "",
angle_col = 0,
fontsize_row = 30,          # Row label size
fontsize_col = 20,          # Column label size
border_color = NA,
treeheight_row = 0,        # Tree height for rows
treeheight_col = 0,         # Don't show a column dendrogram
plot.margin = margin(10, 10, 10, 150),  # Add more space for row labels on the left
legend = FALSE,             # Disable legend
legend.title = "NES",       # Title for the legend
legend.label = TRUE,
legend.cex = 1.5,           # Legend size
legend.height = 8,
legend.width = 4
)
# This should work with the correct argument setup.
heatmap_grob <- grid::grid.grabExpr(print(pheatmap_obj))
grid::editGrob(heatmap_grob, gPath("guide-box"), gp = gpar(fontsize = 30))  # Modify legend size
# === 4. Ridge Plot Prep Function === #
extract_gene_logfc <- function(gsea_df, logfc_column) {
gsea_df %>%
separate_rows(core_enrichment, sep = "/") %>%
rename(hgnc_id = core_enrichment) %>%
left_join(deg_df, by = "hgnc_id") %>%
select(Description, hgnc_id, all_of(logfc_column)) %>%
rename(logFC = all_of(logfc_column))
}
ridge_data_2d <- extract_gene_logfc(shared_deg1, "logFC_2Day")
ridge_data_5d <- extract_gene_logfc(shared_deg2, "logFC_5Day")
# Combine 2d and 5d ridge data
ridge_data_2d$Timepoint <- "2 dpi"
ridge_data_5d$Timepoint <- "5 dpi"
ridge_combined_df <- bind_rows(ridge_data_2d, ridge_data_5d)
# Restrict to top pathways (same order as heatmap)
# Extract the clustered row order from the heatmap
clustered_order <- rownames(combined_nes)[pheatmap_obj$tree_row$order]
# Apply the same order to the ridge plot
ridge_combined_df <- ridge_combined_df %>%
filter(Description %in% clustered_order) %>%
mutate(Description = factor(Description, levels = rev(clustered_order)))  # match heatmap clustering
# Plot
ridge_plot <- ggplot(ridge_combined_df, aes(x = logFC, y = Description, fill = Timepoint)) +
geom_density_ridges(alpha = 0.9, scale = 3.2, rel_min_height = 0.04) +
theme_minimal(base_size = 10) +
scale_fill_manual(values = c("2 dpi" = "#336FA6", "5 dpi" = "#FFD200"))+
theme(
axis.title.y = element_text(size = 40, color = "black"),
axis.text.y = element_text(size = 30, angle = 0, hjust = 1, color = "black"),
axis.text.x = element_text(size = 25, color = "black"),
plot.title = element_text(size = 18, face = "bold", color = "black"),
plot.margin = margin(10, 10, 10, 150),
# legend.title = element_text(size = 20),
# legend.text = element_text(size = 20),
# legend.key.size = unit(1.5, "cm"),
# legend.key.width = unit(1.5, "cm"),
# legend.position = c(0.88, 0.98),
#  legend.background = element_rect(fill = "transparent", color = NA)
) +
labs(
title = "",
x = "Log2 Fold Change",
y = NULL
) +
guides(fill = guide_legend(title = "Timepoint"))
# === 5. NES Ridge Plot === #
nes_df <- combined_nes %>%
rownames_to_column("Pathway") %>%
pivot_longer(cols = c(`2 dpi`, `5 dpi`), names_to = "Timepoint", values_to = "NES")
ridge_nes <- ggplot(nes_df, aes(x = NES, y = Timepoint, fill = Timepoint)) +
geom_density_ridges(alpha = 0.8) +
theme_minimal() +
labs(title = "C: NES Score Distribution", x = "Normalized Enrichment Score", y = NULL) +
scale_fill_manual(values = c("2 dpi" = "#4575b4", "5 dpi" = "#d73027")) +
theme(legend.position = "none")
# === 7. Final Figure === #
# Combine the ridge plot and heatmap into one figure
combined_plot <- plot_grid(
ridge_plot,         # Ridge plot goes on the left
heatmap_grob,       # Heatmap goes on the right
labels = c("", ""), # You can change the labels if needed
ncol = 2,           # Arrange the plots in 1 row, 2 columns
rel_widths = c(1, 1)  # Adjust the relative width of the plots (heatmap will be slightly wider)
)
# Check if logFC values are positive before plotting
print(range(ridge_combined_df$logFC))
# Save the combined figure as PNG
ggsave("Combined_Figure.pdf", plot = combined_plot, width = 45, height = 30, units = "in", dpi = 2000)
# Save
ggsave("GSEA Heatmap.pdf", plot = heatmap_grob, width = 24, height = 24, units = "in", dpi = 1200)
# Save ridge plot separately with better dimensions
ggsave("GSEA_ridge_with_labels_and_pval.pdf", plot = ridge_plot, width = 24, height = 18, units = "in", dpi = 1200)
colnames(gsea_deg1@result)
# Check for negative logFC values before plotting
summary(ridge_combined_df$logFC)
# Create lists of significant up-regulated and down-regulated pathways
# For 2 Day CVB
up_deg1 <- gsea_deg1@result %>%
filter(p.adjust <= 0.05, enrichmentScore > 0) %>%
pull(Description)
down_deg1 <- gsea_deg1@result %>%
filter(p.adjust <= 0.05, enrichmentScore < 0) %>%
pull(Description)
# For 5 Day CVB
up_deg2 <- gsea_deg2@result %>%
filter(p.adjust <= 0.05, enrichmentScore > 0) %>%
pull(Description)
down_deg2 <- gsea_deg2@result %>%
filter(p.adjust <= 0.05, enrichmentScore < 0) %>%
pull(Description)
# Create separate lists for Venn input
venn_list_up <- list(
"2 dpi (Up)" = up_deg1,
"5 dpi (Up)" = up_deg2
)
venn_list_down <- list(
"2 dpi (Down)" = down_deg1,
"5 dpi (Down)" = down_deg2
)
# Create separate Venn diagrams for up-regulated and down-regulated pathways
venn_plot_up <- ggVennDiagram(
venn_list_up,
label_alpha = 0,
label = "count"
) +
scale_fill_gradient(low = "#D6EAF8", high = "#2E86C1") +
theme_void(base_size = 18) +
theme(
plot.title = element_text(size = 26, face = "bold", hjust = 0.5),
legend.position = "none"
) +
labs(title = "Shared and Unique Up-Regulated GSEA Pathways")
venn_plot_down <- ggVennDiagram(
venn_list_down,
label_alpha = 0,
label = "count"
) +
scale_fill_gradient(low = "#D6EAF8", high = "#2E86C1") +
theme_void(base_size = 18) +
theme(
plot.title = element_text(size = 26, face = "bold", hjust = 0.5),
legend.position = "none"
) +
labs(title = "Shared and Unique Down-Regulated GSEA Pathways")
# Save the final plots
ggsave("GSEA_Venn_Diagram_UpRegulated.pdf", plot = venn_plot_up, width = 10, height = 8, dpi = 600)
ggsave("GSEA_Venn_Diagram_DownRegulated.pdf", plot = venn_plot_down, width = 10, height = 8, dpi = 600)
# === 1. Map HGNC symbols to Entrez IDs using org.Hs.eg.db === #
get_entrez_ids <- function(core_enrichment_genes) {
# Map HGNC symbol to Entrez IDs using org.Hs.eg.db
entrez_ids <- sapply(core_enrichment_genes, function(symbol) {
# Try to get Entrez ID
entrez <- tryCatch({
as.character(org.Hs.egSYMBOL2EG[[symbol]])
}, error = function(e) {NA})
return(entrez)
})
return(entrez_ids)
}
# === 2. Extract core enrichment genes and map Entrez IDs === #
extract_gene_logfc_with_entrez <- function(gsea_df, logfc_column) {
gsea_df %>%
separate_rows(core_enrichment, sep = "/") %>%
rename(hgnc_id = core_enrichment) %>%  # Correct column name here
left_join(deg_df, by = "hgnc_id") %>%  # Join on hgnc_id instead of hgnc_symbol
mutate(entrezgene_id = get_entrez_ids(hgnc_id)) %>%
select(Description, hgnc_id, entrezgene_id, all_of(logfc_column)) %>%
rename(logFC = all_of(logfc_column))
}
# Extract and save the 2-day and 5-day data separately
ridge_data_2d <- extract_gene_logfc_with_entrez(shared_deg1, "logFC_2Day")
ridge_data_5d <- extract_gene_logfc_with_entrez(shared_deg2, "logFC_5Day")
# Save the results to separate CSV files
write.csv(ridge_data_2d, "GSEA_2Day_Entrez_Log2FC.csv", row.names = FALSE)
write.csv(ridge_data_5d, "GSEA_5Day_Entrez_Log2FC.csv", row.names = FALSE)
gseaplot(gsea_deg1, geneSetID = top_deg1$ID[1], title = top_deg1$Description[1])
# Load packages
library(clusterProfiler)
library(org.Hs.eg.db)
library(dplyr)
library(tidyr)
library(tibble)
library(pheatmap)
library(ggplot2)
library(ggridges)
library(forcats)
library(grid)
library(cowplot)
library(grid)
library(scales)
library(enrichplot)
# Install biomaRt if not already installed
# install.packages("biomaRt")
# install.packages("ggVennDiagram")  # Uncomment if not already installed
library(ggVennDiagram)
# === 1. Load DEG data === #
deg_2d <- read.csv("2DayCVB_3Col_hgnc.csv")      # Replace with actual filename
deg_5d <- read.csv("5DayCVB_3Col_hgnc.csv")      # Replace with actual filename
deg_df <- full_join(deg_2d, deg_5d, by = "hgnc_id", suffix = c("_2Day", "_5Day"))
# Ensure column names are clean
colnames(deg_2d) <- c("hgnc_id", "logFC_2Day", "pval_2Day")
colnames(deg_5d) <- c("hgnc_id", "logFC_5Day", "pval_5Day")
# Join by gene symbol
deg_df <- full_join(deg_2d, deg_5d, by = "hgnc_id")
# === 2. Top pathways setup === #
top_n <- 75
top_deg1 <- gsea_deg1@result %>% arrange(p.adjust) %>% head(top_n)
top_deg2 <- gsea_deg2@result %>% arrange(p.adjust) %>% head(top_n)
#Pathway truncation
#top_deg1$Description <- substr(top_deg1$Description, 1, 80)
#top_deg2$Description <- substr(top_deg2$Description, 1, 80)
shared_pathways <- intersect(top_deg1$Description, top_deg2$Description)
shared_deg1 <- gsea_deg1@result %>%
filter(Description %in% shared_pathways) %>%
select(Description, NES, core_enrichment) %>%
mutate(Timepoint = "2 dpi")
shared_deg2 <- gsea_deg2@result %>%
filter(Description %in% shared_pathways) %>%
select(Description, NES, core_enrichment) %>%
mutate(Timepoint = "5 dpi")
# === 3. Heatmap data === #
combined_nes <- bind_rows(shared_deg1, shared_deg2) %>%
select(Description, NES, Timepoint) %>%
pivot_wider(names_from = Timepoint, values_from = NES) %>%
column_to_rownames("Description")
combined_nes <- combined_nes[order(combined_nes$`2 dpi`, decreasing = TRUE), ]
custom_palette <- colorRampPalette(c("#deebf7", "#3182bd"))(50)
pheatmap_obj <- pheatmap(
combined_nes,
cluster_rows = TRUE,        # Keep rows clustered
cluster_cols = FALSE,       # Don't cluster columns
color = custom_palette,
main = "",
angle_col = 0,
fontsize_row = 30,          # Row label size
fontsize_col = 20,          # Column label size
border_color = NA,
treeheight_row = 0,        # Tree height for rows
treeheight_col = 0,         # Don't show a column dendrogram
plot.margin = margin(10, 10, 10, 150),  # Add more space for row labels on the left
legend = TRUE,             # Disable legend
legend.title = "NES",       # Title for the legend
legend.label = TRUE,
legend.cex = 1.5,           # Legend size
legend.height = 8,
legend.width = 4
)
# This should work with the correct argument setup.
heatmap_grob <- grid::grid.grabExpr(print(pheatmap_obj))
grid::editGrob(heatmap_grob, gPath("guide-box"), gp = gpar(fontsize = 30))  # Modify legend size
# === 4. Ridge Plot Prep Function === #
extract_gene_logfc <- function(gsea_df, logfc_column) {
gsea_df %>%
separate_rows(core_enrichment, sep = "/") %>%
rename(hgnc_id = core_enrichment) %>%
left_join(deg_df, by = "hgnc_id") %>%
select(Description, hgnc_id, all_of(logfc_column)) %>%
rename(logFC = all_of(logfc_column))
}
ridge_data_2d <- extract_gene_logfc(shared_deg1, "logFC_2Day")
ridge_data_5d <- extract_gene_logfc(shared_deg2, "logFC_5Day")
# Combine 2d and 5d ridge data
ridge_data_2d$Timepoint <- "2 dpi"
ridge_data_5d$Timepoint <- "5 dpi"
ridge_combined_df <- bind_rows(ridge_data_2d, ridge_data_5d)
# Restrict to top pathways (same order as heatmap)
# Extract the clustered row order from the heatmap
clustered_order <- rownames(combined_nes)[pheatmap_obj$tree_row$order]
# Apply the same order to the ridge plot
ridge_combined_df <- ridge_combined_df %>%
filter(Description %in% clustered_order) %>%
mutate(Description = factor(Description, levels = rev(clustered_order)))  # match heatmap clustering
# Plot
ridge_plot <- ggplot(ridge_combined_df, aes(x = logFC, y = Description, fill = Timepoint)) +
geom_density_ridges(alpha = 0.9, scale = 3.2, rel_min_height = 0.04) +
theme_minimal(base_size = 10) +
scale_fill_manual(values = c("2 dpi" = "#336FA6", "5 dpi" = "#FFD200"))+
theme(
axis.title.y = element_text(size = 40, color = "black"),
axis.text.y = element_text(size = 30, angle = 0, hjust = 1, color = "black"),
axis.text.x = element_text(size = 25, color = "black"),
plot.title = element_text(size = 18, face = "bold", color = "black"),
plot.margin = margin(10, 10, 10, 150),
# legend.title = element_text(size = 20),
# legend.text = element_text(size = 20),
# legend.key.size = unit(1.5, "cm"),
# legend.key.width = unit(1.5, "cm"),
# legend.position = c(0.88, 0.98),
#  legend.background = element_rect(fill = "transparent", color = NA)
) +
labs(
title = "",
x = "Log2 Fold Change",
y = NULL
) +
guides(fill = guide_legend(title = "Timepoint"))
# === 5. NES Ridge Plot === #
nes_df <- combined_nes %>%
rownames_to_column("Pathway") %>%
pivot_longer(cols = c(`2 dpi`, `5 dpi`), names_to = "Timepoint", values_to = "NES")
ridge_nes <- ggplot(nes_df, aes(x = NES, y = Timepoint, fill = Timepoint)) +
geom_density_ridges(alpha = 0.8) +
theme_minimal() +
labs(title = "C: NES Score Distribution", x = "Normalized Enrichment Score", y = NULL) +
scale_fill_manual(values = c("2 dpi" = "#4575b4", "5 dpi" = "#d73027")) +
theme(legend.position = "none")
# === 7. Final Figure === #
# Combine the ridge plot and heatmap into one figure
combined_plot <- plot_grid(
ridge_plot,         # Ridge plot goes on the left
heatmap_grob,       # Heatmap goes on the right
labels = c("", ""), # You can change the labels if needed
ncol = 2,           # Arrange the plots in 1 row, 2 columns
rel_widths = c(1, 1)  # Adjust the relative width of the plots (heatmap will be slightly wider)
)
# Check if logFC values are positive before plotting
print(range(ridge_combined_df$logFC))
# Save the combined figure as PNG
ggsave("Combined_Figure.pdf", plot = combined_plot, width = 45, height = 30, units = "in", dpi = 2000)
# Save
ggsave("GSEA Heatmap.pdf", plot = heatmap_grob, width = 24, height = 24, units = "in", dpi = 1200)
# Save ridge plot separately with better dimensions
ggsave("GSEA_ridge_with_labels_and_pval.pdf", plot = ridge_plot, width = 24, height = 18, units = "in", dpi = 1200)
colnames(gsea_deg1@result)
# Check for negative logFC values before plotting
summary(ridge_combined_df$logFC)
# Create lists of significant up-regulated and down-regulated pathways
# For 2 Day CVB
up_deg1 <- gsea_deg1@result %>%
filter(p.adjust <= 0.05, enrichmentScore > 0) %>%
pull(Description)
down_deg1 <- gsea_deg1@result %>%
filter(p.adjust <= 0.05, enrichmentScore < 0) %>%
pull(Description)
# For 5 Day CVB
up_deg2 <- gsea_deg2@result %>%
filter(p.adjust <= 0.05, enrichmentScore > 0) %>%
pull(Description)
down_deg2 <- gsea_deg2@result %>%
filter(p.adjust <= 0.05, enrichmentScore < 0) %>%
pull(Description)
# Create separate lists for Venn input
venn_list_up <- list(
"2 dpi (Up)" = up_deg1,
"5 dpi (Up)" = up_deg2
)
venn_list_down <- list(
"2 dpi (Down)" = down_deg1,
"5 dpi (Down)" = down_deg2
)
# Create separate Venn diagrams for up-regulated and down-regulated pathways
venn_plot_up <- ggVennDiagram(
venn_list_up,
label_alpha = 0,
label = "count"
) +
scale_fill_gradient(low = "#D6EAF8", high = "#2E86C1") +
theme_void(base_size = 18) +
theme(
plot.title = element_text(size = 26, face = "bold", hjust = 0.5),
legend.position = "none"
) +
labs(title = "Shared and Unique Up-Regulated GSEA Pathways")
venn_plot_down <- ggVennDiagram(
venn_list_down,
label_alpha = 0,
label = "count"
) +
scale_fill_gradient(low = "#D6EAF8", high = "#2E86C1") +
theme_void(base_size = 18) +
theme(
plot.title = element_text(size = 26, face = "bold", hjust = 0.5),
legend.position = "none"
) +
labs(title = "Shared and Unique Down-Regulated GSEA Pathways")
# Save the final plots
ggsave("GSEA_Venn_Diagram_UpRegulated.pdf", plot = venn_plot_up, width = 10, height = 8, dpi = 600)
ggsave("GSEA_Venn_Diagram_DownRegulated.pdf", plot = venn_plot_down, width = 10, height = 8, dpi = 600)
# === 1. Map HGNC symbols to Entrez IDs using org.Hs.eg.db === #
get_entrez_ids <- function(core_enrichment_genes) {
# Map HGNC symbol to Entrez IDs using org.Hs.eg.db
entrez_ids <- sapply(core_enrichment_genes, function(symbol) {
# Try to get Entrez ID
entrez <- tryCatch({
as.character(org.Hs.egSYMBOL2EG[[symbol]])
}, error = function(e) {NA})
return(entrez)
})
return(entrez_ids)
}
# === 2. Extract core enrichment genes and map Entrez IDs === #
extract_gene_logfc_with_entrez <- function(gsea_df, logfc_column) {
gsea_df %>%
separate_rows(core_enrichment, sep = "/") %>%
rename(hgnc_id = core_enrichment) %>%  # Correct column name here
left_join(deg_df, by = "hgnc_id") %>%  # Join on hgnc_id instead of hgnc_symbol
mutate(entrezgene_id = get_entrez_ids(hgnc_id)) %>%
select(Description, hgnc_id, entrezgene_id, all_of(logfc_column)) %>%
rename(logFC = all_of(logfc_column))
}
# Extract and save the 2-day and 5-day data separately
ridge_data_2d <- extract_gene_logfc_with_entrez(shared_deg1, "logFC_2Day")
ridge_data_5d <- extract_gene_logfc_with_entrez(shared_deg2, "logFC_5Day")
# Save the results to separate CSV files
write.csv(ridge_data_2d, "GSEA_2Day_Entrez_Log2FC.csv", row.names = FALSE)
write.csv(ridge_data_5d, "GSEA_5Day_Entrez_Log2FC.csv", row.names = FALSE)
gseaplot(gsea_deg1, geneSetID = top_deg1$ID[1], title = top_deg1$Description[1])
